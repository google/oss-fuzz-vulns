id: OSV-2024-1053
summary: Heap-buffer-overflow in gguf_get_tensor_offset
details: |
  OSS-Fuzz report: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=42538148

  ```
  Crash type: Heap-buffer-overflow READ 8
  Crash state:
  gguf_get_tensor_offset
  llama_model_loader::llama_tensor_weight::llama_tensor_weight
  void std::__1::vector<llama_model_loader::llama_tensor_weight, std::__1::allocat
  ```
modified: '2025-01-10T05:05:50.790792Z'
published: '2024-09-13T00:00:16.432562Z'
references:
- type: REPORT
  url: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=42538148
affected:
- package:
    name: llamacpp
    ecosystem: OSS-Fuzz
    purl: pkg:generic/llamacpp
  ranges:
  - type: GIT
    repo: https://github.com/ggerganov/llama.cpp
    events:
    - introduced: 49271efbaf3f7a4ae52c4ca299b6d4e82598a97d
    - fixed: e597e50794f07ec8dc24b9efb18f94ec6386fda0
  versions:
  - b3649
  - b3651
  - b3652
  - b3654
  - b3655
  - b3656
  - b3658
  - b3661
  - b3664
  - b3666
  - b3667
  - b3668
  - b3669
  - b3671
  - b3672
  - b3674
  - b3675
  - b3676
  - b3677
  - b3678
  - b3680
  - b3681
  - b3682
  - b3683
  - b3684
  - b3685
  - b3686
  - b3687
  - b3688
  - b3699
  - b3700
  - b3701
  - b3702
  - b3703
  - b3704
  - b3705
  - b3706
  - b3707
  - b3711
  - b3713
  - b3714
  - b3715
  - b3716
  - b3717
  - b3718
  - b3720
  - b3721
  - b3722
  - b3723
  - b3725
  - b3726
  - b3727
  - b3728
  - b3729
  - b3731
  - b3733
  - b3735
  - b3737
  - b3738
  - b3740
  - b3743
  - b3744
  - b3747
  - b3749
  - b3750
  - b3751
  - b3752
  - b3753
  - b3754
  - b3755
  - b3756
  - b3759
  - b3760
  - b3761
  - b3763
  - b3764
  - b3765
  - b3766
  - b3767
  - b3770
  - b3771
  - b3772
  - b3774
  - b3775
  - b3777
  - b3778
  - b3779
  - b3781
  - b3782
  - b3783
  - b3785
  - b3786
  - b3787
  - b3788
  - b3789
  - b3790
  - b3795
  - b3797
  - b3798
  - b3799
  - b3800
  - b3801
  - b3802
  - b3803
  - b3804
  - b3805
  - b3806
  - b3807
  - b3808
  - b3811
  - b3812
  - b3813
  - b3814
  - b3816
  - b3817
  - b3818
  - b3820
  - b3821
  - b3822
  - b3823
  - b3824
  - b3825
  - b3827
  - b3828
  - b3829
  - b3831
  - b3832
  - b3834
  - b3835
  - b3837
  - b3841
  - b3847
  - b3848
  - b3849
  - b3853
  - b3855
  - b3856
  - b3861
  - b3863
  - b3864
  - b3865
  - b3866
  - b3867
  - b3868
  - b3869
  - b3870
  - b3872
  - b3873
  - b3874
  - b3878
  - b3879
  - b3880
  - b3883
  - b3886
  - b3887
  - b3889
  - b3892
  - b3895
  - b3896
  - b3898
  - b3899
  - b3901
  - b3902
  - b3903
  - b3904
  - b3905
  - b3906
  - b3907
  - b3909
  - b3911
  - b3912
  - b3914
  - b3916
  - b3917
  - b3920
  - b3921
  - b3922
  - b3923
  - b3925
  - b3926
  - b3927
  - b3930
  - b3931
  - b3932
  - b3933
  - b3935
  - b3936
  - b3938
  - b3939
  - b3940
  - b3941
  - b3942
  - b3943
  - b3946
  - b3947
  - b3948
  - b3949
  - b3950
  - b3952
  - b3957
  - b3958
  - b3960
  - b3961
  - b3962
  - b3964
  - b3967
  - b3970
  - b3971
  - b3972
  - b3974
  - b3975
  - b3976
  - b3977
  - b3978
  - b3982
  - b3983
  - b3984
  - b3985
  - b3987
  - b3988
  - b3989
  - b3990
  - b3991
  - b3994
  - b3995
  - b3996
  - b3997
  - b3998
  - b3999
  - b4000
  - b4001
  - b4002
  - b3665
  - b3673
  - b3736
  - b3746
  - b3748
  - b3757
  - b3758
  - b3769
  - b3796
  - b3810
  - b3928
  - b3937
  - b3959
  - b3965
  - b3969
  ecosystem_specific:
    severity: MEDIUM
  database_specific:
    introduced_range: 0ab30f8d82fc7156b750c194d64a887e80cbfb82:a47667cff41f5a198eb791974e0afcc1cddd3229
    fixed_range: 61408e7fad082dc44a11c8a9f1398da4837aad44:e597e50794f07ec8dc24b9efb18f94ec6386fda0
schema_version: 1.6.0
